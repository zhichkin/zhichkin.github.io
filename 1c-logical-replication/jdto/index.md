---
title: Формат JDTO
description: JSON data transfer object
---
[Назад](/dajet-blog/#логическая-репликация-1с-предприятие-8)

### JSON data transfer object

Данный документ описывает формат JSON для сериализации данных объектов 1С. JDTO может быть использован для организации обмена данными между базами данных 1С и внешними системами. Данный формат является основным для [механизма логической репликации](/1c-logical-replication) 1С:Предприятие 8. [Исходный код](https://github.com/zhichkin/1c-logical-replication/blob/main/src/CommonModules/%D0%A1%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80JDTO/Ext/Module.bsl) сериализатора JDTO на языке 1С.

1. [Простые типы данных](#простые-типы-данных)
2. [Ссылочные типы данных](#ссылочные-типы-данных)
3. [Значения перечислений](#значения-перечислений)
4. [Табличные части объектов](#табличные-части-объектов)
5. [Составной тип данных](#составной-тип-данных)
6. Наборы записей регистров
7. Удаление ссылочного объекта
8. Пример документа в формате JDTO
9. Пример набора записей в формате JDTO

#### Простые типы данных

Простые типы данных сериализуются в формат JSON согласно общепринятым правилам для этих типов, описанных, например, в стандарте JSON Schema.

|Тип данных|Значение JSON|
|---|---|
|Неопределено|null|
|Булево|true или false|
|Число|1234 или 12.34 или -1234 или -12.34|
|Дата|"2025-01-01T00:00:00"|
|Строка|"Это строковое значение"|
|ХранилищеЗначения|Двоичные данные в формате BASE64|
|УникальныйИдентификатор|"841e82c6-b88b-42ed-83c5-be5a5cb20636"|
|ВидДвиженияНакопления|"Приход" или "Расход"|

**Пример JSON Schema для простых типов данных:**

```
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Пример для простых типов данных",
  "type": "object",
  "properties": {
    "Неопределено": { "type": "null" },
    "Булево": { "type": "boolean" },
    "Число": { "type": "number" },
    "Строка": { "type": "string" },
    "Дата": {
      "type": "string",
      "format": "date-time"
    },
    "ХранилищеЗначения": {
      "type": "string",
      "contentEncoding": "base64"
    },
    "УникальныйИдентификатор": {
      "type": "string",
      "format": "uuid"
    }
  }
}
```

[Наверх](#json-data-transfer-object)

#### Ссылочные типы данных

Ссылки сериализуются как объект, имеющий два свойства "type" и "value". Свойство "type" определяет тип ссылки, а свойство "value" хранит её значение.

Тип ссылки указывает на таблицу базы данных, а значение является значением первичного ключа этой таблицы.

Например, ссылка на элемент справочника "Номенклатура" в базе данных в формате JDTO выглядит следующим образом:

```
{
  "type": "Справочник.Номенклатура",
  "value": "841e82c6-b88b-42ed-83c5-be5a5cb20636"
}
```

**Пример JSON Schema для ссылки:**

```
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "ObjectRef",
  "description": "Ссылка на объект в базе данных",
  "type": "object",
  "properties": {
    "type": { "type": "string" },
    "value": { "type": "string", "format": "uuid" }
  },
  "required": [ "type", "value" ],
  "additionalProperties": false
}
```

[Наверх](#json-data-transfer-object)

#### Значения перечислений

Не смотря на то, что перечисления имеют ссылочный тип данных, их значения сериализуются как строковое представление псевдонима.

```
{
  "type": "Перечисление.СтавкиНДС",
  "value": "НДС10"
}
```

**Пример JSON Schema для ссылок на значения перечислений:**

```
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "EnumRef",
  "description": "Ссылка на значение перечисления",
  "type": "object",
  "properties": {
    "type": { "type": "string", "pattern": "^Перечисление" },
    "value": { "type": "string", "not": { "format": "uuid" }
    }
  },
  "required": [ "type", "value" ],
  "additionalProperties": false
}
```

[Наверх](#json-data-transfer-object)

#### Табличные части объектов

Ссылочные объекты могут иметь табличные части. Табличная часть объекта это набор записей дочерней таблицы. Таких таблиц может быть несколько или ни одной. Свойство объекта, в котором находится значение табличной части, является массивом объектов.

Свойства записей табличных частей сериализуются по тем же правилам и в том же формате, что и свойства ссылочных объектов.

Табличные части не могут быть вложены друг в друга. То есть иерархия для всех JSON объектов ограничена двумя уровнями.

**Пример JSON Schema для свойства объекта, значением которого является табличная часть:**

```
{
  "Товары": {
    "type": "array",
    "items": {
      "type": "object",
      "properties": {
        "СвойствоТабличнойЧасти": { "type": "string" }
      }
    }
  }
}
```

[Наверх](#json-data-transfer-object)

#### Составной тип данных

Свойства объектов могут иметь составной тип данных. Это означает, что в разные моменты времени значение свойства может быть разным типом данных. Например, значением свойства может быть числовой, строковый или ссылочный тип данных. Аналогичным составному типу данных является, например, тип данных **sql_variant**.

> В информатике такие типы данных называются "tagged union" или "discriminated union".

Значение составного типа в формат JSON сериализуется по тем же правилам, как описано выше, в зависимости от того какое конкретное значение имеет свойство объекта в данный момент времени.

Для описания составных типов данных при помощи JSON Schema предусмотрено ключевого слово **oneOf**. Постольку поскольку это ключевое слово должно содержать массив схем данных, которые используются для валидации текущего фактического значения свойства объекта, необходимо описать все возможные варианты значений составного типа.

**Пример JSON Schema для составного типа значения:**

Ниже следующий пример определяет схему данных для объекта со свойством "СоставнойТип", значением которого могут быть все варианты значений: простые и ссылочные типы данных.

> Подобное описание составного типа необходимо в первую очередь принимающей стороне, чтобы понимать, что значение соответствующего свойства может иметь различные типы данных.

```
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Пример описания составного типа данных",
  "type": "object",
  "properties": {
    "СоставнойТип": {
      "oneOf": [
        { "type": "null" },
        { "type": "boolean" },
        { "type": "number" },
        { "type": "string", "format": "date-time" },
        { "type": "string", "not": { "format": "date-time" } },
        { "type": "#/$defs/EnumRef" },
        { "type": "#/$defs/ObjectRef" }
      ]
    }
  }
}
```

[Наверх](#json-data-transfer-object)
